import{_ as n}from"./preload-helper.a4192956.js";import{w as r}from"./singletons.434e14c9.js";const s=r(null),i=r(!1),f=r(!1),u=r(null);{const e=localStorage.getItem("authToken"),o=localStorage.getItem("user");if(e&&o)try{n(()=>import("./auth.36f9ee17.js"),["./auth.36f9ee17.js","./preload-helper.a4192956.js","./scheduler.cc6cbc02.js","./paths.f059e082.js","./singletons.434e14c9.js"],import.meta.url).then(({isTokenExpired:t,setupTokenRefreshTimer:l,setupVisibilityChangeHandler:a,autoRefreshToken:m})=>{t(e)?(console.log("Stored token is expired, attempting auto refresh..."),m()):(u.set(e),s.set(JSON.parse(o)),i.set(!0),l(),a())})}catch(t){console.error("Failed to parse stored user data:",t),c()}}function d(e,o,t=null){localStorage.setItem("authToken",e),localStorage.setItem("user",JSON.stringify(o)),t&&localStorage.setItem("refreshToken",t),u.set(e),s.set(o),i.set(!0),n(()=>import("./auth.36f9ee17.js"),["./auth.36f9ee17.js","./preload-helper.a4192956.js","./scheduler.cc6cbc02.js","./paths.f059e082.js","./singletons.434e14c9.js"],import.meta.url).then(({setupTokenRefreshTimer:l,setupVisibilityChangeHandler:a})=>{l(),a()})}function c(){localStorage.removeItem("authToken"),localStorage.removeItem("user"),localStorage.removeItem("refreshToken"),u.set(null),s.set(null),i.set(!1),n(()=>import("./auth.36f9ee17.js"),["./auth.36f9ee17.js","./preload-helper.a4192956.js","./scheduler.cc6cbc02.js","./paths.f059e082.js","./singletons.434e14c9.js"],import.meta.url).then(({clearTokenRefreshTimer:e})=>{e()})}function p(e){localStorage.setItem("user",JSON.stringify(e)),s.set(e)}export{u as authToken,i as isAuthenticated,f as isLoading,d as login,c as logout,p as updateUser,s as user};
